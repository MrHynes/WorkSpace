package com.dao.dao.imp;

import java.sql.Connection;
import java.sql.PreparedStatement;
import java.util.ArrayList;
import java.util.Date;
import java.util.List;

import com.dao.dao.IEmpDao;
import com.dao.vo.Emp;

public class EmpDAOImpl implements IEmpDao {

	private Connection conn=null;
	private PreparedStatement pstm=null;
	public EmpDAOImpl(Connection conn) {
		this.conn=conn;
	}
	//ÐÂÔöÕÊ»§
	@Override
	public boolean doCreate(Emp emp) throws Exception {
		boolean flag=false;
		String sql="insert into emp values(?,?,?,?,?)";
		this.pstm=this.conn.prepareStatement(sql);
		this.pstm.setInt(1, emp.getEmpno());
		this.pstm.setString(2, emp.getEmname());
		this.pstm.setString(3, emp.getJob());
		this.pstm.setDate(4,new java.sql.Date(emp.getHiredate().getTime()));
		this.pstm.setFloat(5, emp.getSal());
		if(this.pstm.executeUpdate()>0){
			flag=true;
		}
		this.conn.close();
		return flag;
	}

	@Override
	public List<Emp> findAll(String keyWord) throws Exception {
		List<Emp> all=new ArrayList<Emp>();
	}

	@Override
	public Emp findByID(int empno) throws Exception {
		// TODO Auto-generated method stub
		return null;
	}

}
